/**
 * @file    debug_uart.h
 * @brief   Panel UART 115200 8N1 (ANSI) do debugowania w miejscu (TX nieblokujące przez IRQ).
 * @date    2025-11-02
 *
 * Uwaga:
 *   - API bez zmian względem baseline (Init/Print/Printf/SensorsDual).
 *   - Wysyłanie odbywa się asynchronicznie (HAL_UART_Transmit_IT) z bufora cyklicznego.
 */

#ifndef DEBUG_UART_H_
#define DEBUG_UART_H_

#include "main.h"
#include <stdarg.h>

#ifdef __cplusplus
extern "C" {
#endif

/* Konfigurowalny rozmiar bufora TX (bajtów). Zmień tu, jeśli potrzebujesz więcej/mniej. */
#ifndef DEBUG_UART_RB_SIZE
#define DEBUG_UART_RB_SIZE 1024u
#endif

/* Inicjalizacja modułu: zapamiętuje uchwyt UART (np. &huart2). */
void DebugUART_Init(UART_HandleTypeDef *huart);

/* Jedna linia tekstu: do kolejki trafia msg + CRLF. Nie blokuje. */
void DebugUART_Print(const char *msg);

/* Wersja printf: formatuje do bufora lokalnego i wrzuca do kolejki + CRLF. Nie blokuje. */
void DebugUART_Printf(const char *fmt, ...);

/* Dwukolumnowy panel diagnostyczny (treść jak w baseline). */
#include "tf_luna_i2c.h"
#include "tcs3472.h"
void DebugUART_SensorsDual(
    const TF_LunaData_t *RightLuna, const TF_LunaData_t *LeftLuna,
    const TCS3472_Data_t *RightColor, const TCS3472_Data_t *LeftColor);

#ifdef __cplusplus
}
#endif
#endif /* DEBUG_UART_H_ */
